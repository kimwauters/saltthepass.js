/*! saltthepass v0.2.0 */
(function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.SaltThePassUtils=e()})(this,function(){"use strict";var t={};return t.standardizeDomain=function(t){if(void 0!==t){var e=t.toLowerCase();return"http://"===e.substring(0,"http://".length)&&(e=e.substring("http://".length)),"https://"===e.substring(0,"https://".length)&&(e=e.substring("https://".length)),-1!==e.indexOf("/")&&(e=e.substring(0,e.indexOf("/"))),e}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["./utils"],e):"object"==typeof exports?module.exports=e(require("./utils")):t.DomainNameRule=e(t.SaltThePassUtils)}(this,function(t){"use strict";function e(t){void 0!==t&&(this.domain=t.domain,this.aliases=t.aliases instanceof Array?t.aliases.slice():[],this.description=t.description,this.min=t.min!==void 0?parseInt(t.min,10)||0:0,this.max=t.max!==void 0?parseInt(t.max,10)||Number.MAX_VALUE:Number.MAX_VALUE,this.invalid=t.invalid!==void 0?t.invalid:"",this.required=t.required!==void 0?t.required:"",this.regex=t.regex)}return e.prototype.hasMin=function(){return 0!==this.min},e.prototype.hasMax=function(){return this.max!==Number.MAX_VALUE},e.prototype.hasRequired=function(){return 0!==this.required.length},e.prototype.hasInvalid=function(){return 0!==this.invalid.length},e.prototype.hasRegex=function(){return this.regex!==void 0},e.prototype.matches=function(e){var i=t.standardizeDomain(e);if(i===this.domain)return!0;for(var r=0;this.aliases.length>r;r++){var n=this.aliases[r];if(n===i)return!0}return!1},e.prototype.isValid=function(t){return this.isValidMin(t)?this.isValidMax(t)?this.isValidRequired(t)?this.isValidInvalid(t)?this.isValidRegex(t)?!0:!1:!1:!1:!1:!1},e.prototype.isValidMin=function(t){return t.length>=this.min},e.prototype.isValidMax=function(t){return t.length<=this.max},e.prototype.isValidRequired=function(t){if(0===this.required.length)return!0;for(var e=!1,i=0;this.required.length>i;i++)if(-1!==t.indexOf(this.required[i])){e=!0;break}return this.required.length>0&&!e?!1:!0},e.prototype.isValidInvalid=function(t){if(0===this.invalid.length)return!0;for(var e=0;this.invalid.length>e;e++)if(-1!==t.indexOf(this.invalid[e]))return!1;return!0},e.prototype.isValidRegex=function(t){if(this.regex){var e=this.getRegEx();if(!e.test(t))return!1}return!0},e.prototype.getRegEx=function(t){return this.regex?t?RegExp("[^"+this.regex+"]","gi"):RegExp("^["+this.regex+"]+$","i"):void 0},e.prototype.rewrite=function(t){if(this.isValid(t))return t;for(var e=t,i=0;this.invalid.length>i;i++)for(var r=-1,n=this.invalid[i];-1!==(r=e.indexOf(n));)e=e.substr(0,r)+e.substr(r+1);if(this.regex){var s=this.getRegEx();if(!s.test(e)){var a=this.getRegEx(!0);e=e.replace(a,"")}}return e=this.trimToMax(e),e=this.addRequiredChar(e),e=this.trimToMax(e),this.isValid(e)?e:void 0},e.prototype.trimToMax=function(t){var e=t;return e.length>this.max&&(e=e.substr(0,this.max)),e},e.prototype.addRequiredChar=function(t){var e=t;if(0===this.required.length)return e;for(var i=!1,r=0;this.required.length>r;r++)if(-1!==e.indexOf(this.required[r])){i=!0;break}if(this.required.length>0&&!i){var n=this.required[0];e=n+e}return e},e}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["saltthepass/domainnamerule","saltthepass/utils","crypto-js/md5","crypto-js/sha1","crypto-js/sha512","crypto-js/sha3","crypto-js/ripemd160","crypto-js/enc-base64"],e):"object"==typeof exports?module.exports=e(require("./domainnamerule"),require("./utils"),require("crypto-js/md5"),require("crypto-js/sha1"),require("crypto-js/sha512"),require("crypto-js/sha3"),require("crypto-js/ripemd160"),require("crypto-js/enc-base64")):t.SaltThePass=e(t.DomainNameRule,t.SaltThePassUtils,t.CryptoJS.MD5,t.CryptoJS.SHA1,t.CryptoJS.SHA512,t.CryptoJS.SHA3,t.CryptoJS.RIPEMD160,t.CryptoJS.enc.Base64)}(this,function(t,e,i,r,n,s,a,o){"use strict";var h={};h.DomainNameRule=t,h.standardizeDomain=e.standardizeDomain;var u={md5:{length:22,fn:i},sha1:{length:27,fn:r},sha2:{length:86,fn:n},sha3:{length:86,fn:s},ripemd160:{length:27,fn:a}};return h.getHashes=function(){var t=[];for(var e in u)u.hasOwnProperty(e)&&t.push(e);return t},h.getHashFn=function(t){return t in u?u[t].fn:void 0},h.getHashLength=function(t){return t in u?u[t].length:0},h.hash=function(t,e){if(void 0!==e&&e.length){var i=this.getHashFn(t);if(void 0!==i){var r=i(e),n=r.toString(o);return n=n.replace(/=+$/,""),n=n.replace(/\+/g,"-"),n=n.replace(/\//g,"_")}}},h.saltthepass=function(t,e,i,r){return e===void 0&&(e=""),i===void 0&&(i=""),r===void 0&&(r=""),this.hash(t,e+i+r)},h});